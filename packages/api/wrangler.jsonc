{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "api",
  "main": "src/index.ts",
  "compatibility_flags": [
    "nodejs_compat",
    "no_handle_cross_request_promise_resolution"
  ],
  "compatibility_date": "2025-05-08",
  "observability": {
    "enabled": true
  },
  "upload_source_maps": true,
  "r2_buckets": [
    {
      "binding": "R2_FILE_TRANSFER_BUCKET",
      "bucket_name": "file-transfer",
      "experimental_remote": true
    },
    {
      "binding": "REPLICATOR_BUCKET",
      "bucket_name": "replicator",
      "experimental_remote": true
    }
  ],
  "durable_objects": {
    "bindings": [{ "name": "SANDBOX_DO", "class_name": "SandboxDurableObject" }]
  },
  "migrations": [{ "tag": "v1", "new_classes": ["SandboxDurableObject"] }],
  "vars": {
    "APP_URL": "http://localhost:5173",
    "SCREENSHOT_API_URL": "http://localhost:8789",
    "PREVIEW_PROXY_URL": "http://localhost:8788",
    "R2_FILE_TRANSFER_BUCKET_NAME": "file-transfer",
    "R2_REPOS_BUCKET_NAME": "repos",
    "REPLICATOR_GIT_SYNC_API_URL": "http://localhost:8888",
    "TZ": "utc",
    "LANGSMITH_TRACING": "true",
    "LANGSMITH_ENDPOINT": "https://api.smith.langchain.com"
  },
  "env": {
    "production": {
      "vars": {
        "APP_URL": "https://app.squash.build",
        "SCREENSHOT_API_URL": "https://screenshot-api-production.squash.workers.dev",
        "PREVIEW_PROXY_URL": "https://magicsite.app",
        "R2_FILE_TRANSFER_BUCKET_NAME": "file-transfer",
        "R2_REPOS_BUCKET_NAME": "repos",
        "REPLICATOR_GIT_SYNC_API_URL": "http://localhost:8888",
        "TZ": "utc",
        "LANGSMITH_TRACING": "true",
        "LANGSMITH_ENDPOINT": "https://api.smith.langchain.com"
      },
      "r2_buckets": [
        {
          "binding": "R2_FILE_TRANSFER_BUCKET",
          "bucket_name": "file-transfer",
          "experimental_remote": true
        },
        {
          "binding": "REPLICATOR_BUCKET",
          "bucket_name": "replicator",
          "experimental_remote": true
        }
      ],
      "durable_objects": {
        "bindings": [
          { "name": "SANDBOX_DO", "class_name": "SandboxDurableObject" }
        ]
      },
      "migrations": [{ "tag": "v1", "new_classes": ["SandboxDurableObject"] }]
    }
  },
  "rules": [{ "type": "Text", "globs": ["**/*.md"], "fallthrough": true }]
}
